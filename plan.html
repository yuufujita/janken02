<!DOCTYPE html>
<html lang="ja">
  <!-- 最初の設定は終わっています　必要な方は触ってください -->

  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Carless travel</title>
    <link rel="stylesheet" href="css/reset.css" />
    <link rel="stylesheet" href="css/style.css" />
    <link rel="icon" type="img/png" href="img/favicon.png" />
  </head>
  <!-- 最初の設定は終わっています　必要な方は触ってください -->

  <body>
    <!-- この中に記述していく -->
    <!-- ここから下にコードを書く -->
    <div id="home">
      <header class="page-header wrapper">
        <div class="logo-area">
          <a href="plan.html"
            ><img class="logo" src="img/logo.jpg" alt="Carlesstravelホーム"
          /></a>
        </div>
        <div class="space-area"></div>
        <nav>
          <ul class="main-nav">
            <li><a href="plan.html">PLAN</a></li>
            <li><a href="index.html">GAME</a></li>
          </ul>
        </nav>
      </header>
    </div>

    <div class="wrapper">
      <article>
        <div id="main00">
          <div class="main-content">
            <h1 class="main-title">Enjoy your freedom</h1>
            <p>自動車運転なしの自由気ままな一人旅に出ましょう</p>
          </div>
        </div>
        <div id="plan" class="contents">
          <h2 class="title">PLAN</h2>
          <p class="sub-title">あなたはどんな一人旅に出ようとしていますか？</p>
          <div class="select-container">
            <div class="select-item">
              <p>月</p>
              <select name="month" class="select01">
                <option value="00">−−−選択してください−−−</option>
                <option value="01">１月</option>
                <option value="02">２月</option>
                <option value="03">３月</option>
                <option value="04">４月</option>
                <option value="05">５月</option>
                <option value="06">６月</option>
                <option value="07">７月</option>
                <option value="08">８月</option>
                <option value="09">９月</option>
                <option value="10">１０月</option>
                <option value="11">１１月</option>
                <option value="12">１２月</option>
              </select>
            </div>
            <div class="select-item">
              <p>期間</p>
              <select name="period" class="select02">
                <option value="0">−−−選択してください−−−</option>
                <option value="1">日帰り</option>
                <option value="2">１泊２日</option>
              </select>
            </div>
            <div class="select-item">
              <p>目的</p>
              <select name="objective" class="select03">
                <option value="0">−−−選択してください−−−</option>
                <option value="1">温泉</option>
                <option value="2">景色</option>
              </select>
            </div>
          </div>
          <div class="recommend"></div>
          <div class="change-area">
            <a input type="button" class="button search">検索</a>
            <a
              input
              type="button"
              class="button default"
              onclick="window.location.reload();"
              >初期化</a
            >
          </div>
          <div class="recommend-container recommend0221">
            <div class="recommend-detail">
              <div class="detail-img">
                <img src="img/travel_101.jpg" alt="コルテラルゴ＆河津桜" />
              </div>
              <div class="detail-memo">
                <p>コルテラルゴ＆河津桜</p>
                <table class="evaluation">
                  <tr>
                    <td class="left01"></td>
                    <td class="right01"></td>
                  </tr>
                  <tr>
                    <td class="left02"></td>
                    <td class="right02"></td>
                  </tr>
                  <tr>
                    <td class="left03"></td>
                    <td class="right03"></td>
                  </tr>
                  <tr>
                    <td class="left04"></td>
                    <td class="right04"></td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
          <div class="recommend-container recommend0222">
            <div class="recommend-detail">
              <div class="detail-img">
                <img src="img/travel_101.jpg" alt="コルテラルゴ＆河津桜" />
              </div>
              <div class="detail-memo">
                <p>コルテラルゴ＆河津桜</p>
                <table class="evaluation">
                  <tr>
                    <td class="left01"></td>
                    <td class="right01"></td>
                  </tr>
                  <tr>
                    <td class="left02"></td>
                    <td class="right02"></td>
                  </tr>
                  <tr>
                    <td class="left03"></td>
                    <td class="right03"></td>
                  </tr>
                  <tr>
                    <td class="left04"></td>
                    <td class="right04"></td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
          <div class="recommend-container recommend0512">
            <div class="recommend-detail">
              <div class="detail-img">
                <img src="img/travel_102.jpg" alt="富士芝桜" />
              </div>
              <div class="detail-memo">
                <p>富士芝桜</p>
                <table class="evaluation">
                  <tr>
                    <td class="left01"></td>
                    <td class="right01"></td>
                  </tr>
                  <tr>
                    <td class="left02"></td>
                    <td class="right02"></td>
                  </tr>
                  <tr>
                    <td class="left03"></td>
                    <td class="right03"></td>
                  </tr>
                  <tr>
                    <td class="left04"></td>
                    <td class="right04"></td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
          <div class="recommend-container recommend0722">
            <div class="recommend-detail">
              <div class="detail-img">
                <img src="img/travel_103.jpg" alt="結び家＆ラベンダー畑" />
              </div>
              <div class="detail-memo">
                <p>結び家＆ラベンダー畑</p>
                <table class="evaluation">
                  <tr>
                    <td class="left01"></td>
                    <td class="right01"></td>
                  </tr>
                  <tr>
                    <td class="left02"></td>
                    <td class="right02"></td>
                  </tr>
                  <tr>
                    <td class="left03"></td>
                    <td class="right03"></td>
                  </tr>
                  <tr>
                    <td class="left04"></td>
                    <td class="right04"></td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
          <div class="recommend-container recommend1012">
            <div class="recommend-detail">
              <div class="detail-img">
                <img src="img/travel_104.jpg" alt="曼珠沙華" />
              </div>
              <div class="detail-memo">
                <p>曼珠沙華</p>
                <table class="evaluation">
                  <tr>
                    <td class="left01"></td>
                    <td class="right01"></td>
                  </tr>
                  <tr>
                    <td class="left02"></td>
                    <td class="right02"></td>
                  </tr>
                  <tr>
                    <td class="left03"></td>
                    <td class="right03"></td>
                  </tr>
                  <tr>
                    <td class="left04"></td>
                    <td class="right04"></td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
          <div class="modal-container modal-container01">
            <div class="modal-body">
              <div class="modal-close">×</div>
              <div class="modal-content">
                <p>
                  ごめんなさい、１件もありません。あなたの投稿をお待ちしています。
                </p>
              </div>
            </div>
          </div>
          <div class="modal-container modal-container02">
            <div class="modal-body">
              <div class="modal-close">×</div>
              <div class="modal-content">
                <p>
                  懐かしのキャラとのじゃんけんゲームで癒されませんか？
                  <br />　クリック→→→<a href="index.html">GAME</a>
                </p>
              </div>
            </div>
          </div>
        </div>
        <div id="map" class="contents">
          <h2 class="title">DESTINATION</h2>
          <div class="map"></div>
          <div class="destination">
            <div id="myMap"></div>
            <div class="directionsContainer">
              <div id="directionsPanel"></div>
              <div id="directionsItinerary"></div>
            </div>
            <!-- 一時的に削除　style="width: 96vw; height: 400px -->
          </div>
          <script
            src="https://www.bing.com/api/maps/mapcontrol?callback=GetMap&key=削除"
            async
            defer
          ></script>
          <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
          <script>
            function GetMap() {
              const map = new Microsoft.Maps.Map("#myMap", {
                center: new Microsoft.Maps.Location(35.669099, 139.703436),
                mapTypeId: Microsoft.Maps.MapTypeId.load,
                zoom: 8,
              });

              // 現在位置を取得
              if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                  function (position) {
                    const currentPosition = new Microsoft.Maps.Location(
                      position.coords.latitude,
                      position.coords.longitude
                    );

                    // 左側_Load the directions module.
                    Microsoft.Maps.loadModule(
                      "Microsoft.Maps.Directions",
                      function () {
                        // Create an instance of the directions manager.
                        const directionsManager =
                          new Microsoft.Maps.Directions.DirectionsManager(map);

                        // 出発地を現在位置に設定
                        const startWaypoint =
                          new Microsoft.Maps.Directions.Waypoint({
                            location: currentPosition,
                          });
                        directionsManager.addWaypoint(startWaypoint, 0);

                        // 目的地を指定位置に設定
                        let month = $("[name=month]").val();
                        let period = $("[name=period]").val();
                        let objective = $("[name=objective]").val();
                        let lat = [
                          35.669099, 34.903636, 35.442928, 43.59575287020896,
                          35.884235,
                        ];
                        let lon = [
                          139.703436, 139.117084, 138.604503,
                          142.46940614130773, 139.309194,
                        ];
                        //コルテラルゴ＆河津桜
                        if (month == 2 && period == 2 && objective == 1) {
                          (lat = lat[1]), (lon = lon[1]);
                        } //コルテラルゴ＆河津桜
                        else if (month == 2 && period == 2 && objective == 2) {
                          (lat = lat[1]), (lon = lon[1]);
                        } //富士芝桜
                        else if (month == 5 && period == 1 && objective == 2) {
                          (lat = lat[2]), (lon = lon[2]);
                        } //結び家＆ラベンダー畑
                        else if (month == 7 && period == 2 && objective == 2) {
                          (lat = lat[3]), (lon = lon[3]);
                        } //曼珠沙華
                        else if (month == 10 && period == 1 && objective == 2) {
                          (lat = lat[4]), (lon = lon[4]);
                        } else {
                          (lat = lat[0]), (lon = lon[0]);
                        }
                        const endWaypoint =
                          new Microsoft.Maps.Directions.Waypoint({
                            location: new Microsoft.Maps.Location(lat, lon),
                          });
                        directionsManager.addWaypoint(endWaypoint, 1);

                        // Specify where to display the route instructions.
                        directionsManager.setRenderOptions({
                          itineraryContainer: "#directionsItinerary",
                        });

                        // Specify where to display the input panel.
                        directionsManager.showInputPanel("directionsPanel");
                      }
                    );

                    // マップを現在位置にセンタリング
                    map.setView({ center: currentPosition });

                    // マップにピンの設定
                    function setPinPosition() {
                      let center = map.getCenter();
                      pin = new Microsoft.Maps.Pushpin(center, {
                        color: "magenta",
                        draggable: true,
                        enableClickedStyle: true,
                        enabledHoverStyle: true,
                        visible: true,
                        title: "おすすめの場所",
                        subTitle: "結び家",
                        text: "ココ",
                      });
                      map.entities.push(pin);
                    }
                    // ピンはいったん非表示
                    //setPinPosition();
                  },
                  function (error) {
                    console.log("現在位置の取得に失敗しました。");
                  }
                );
              } else {
                console.log(
                  "お使いのブラウザはGeolocation APIをサポートしていません。"
                );
              }
            }

            $(".search").on("click", function () {
              GetMap();
            });
          </script>
        </div>
      </article>
    </div>
    <footer>
      <div class="wrapper">
        <p>
          <small>&copy;2023 Yu Fujita</small>
        </p>
      </div>
    </footer>
    <!-- ここから上にコードを書く -->
    <!-- この中に記述していく -->
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script src="js/main.js"></script>
  </body>
</html>
